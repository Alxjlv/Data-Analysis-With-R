---
title: "Engsci 211 Task 3"
author: "Alex Verkerk"
date: "17/05/2019"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).


```{r}
library(s20x)
#laptop:/
#setwd("C:/Users/Alex/Documents/GitHub/Engsci211Assignment2")
#home computer:
setwd("I:/GitHub/Engsci 211/Engsci211Assignment2")
delays.df = read.table("delays.txt", header = TRUE)
head(delays.df)
```
### Exploratory Analysis
```{r}
#delays.fit = lm(dep_delay~airline, data = delays.df)
#layout20x(1,2)
#layout.matrix <- matrix(c(0,1),nrow=1,ncol=2)
#layout(mat=layout.matrix,
      # heights = c(1),#Height of the row
       #widths = c(2,2)) #Widths of the two columns
#par(mar = c(0,2,2,0))
plot(dep_delay~airline,data = delays.df)
#par(mar = c(3,3,3,3))
eovcheck(dep_delay~airline, data = delays.df)
```

```{r}
delays.fit = lm(dep_delay~airline, data = delays.df)
normcheck(delays.fit)
```

```{r}
#layout20x(1,2)
boxplot(log(dep_delay)~airline, data = delays.df)
eovcheck(log(dep_delay)~airline,data=delays.df)
```

```{r}
delays.fit2 = lm(log(dep_delay)~airline,data=delays.df)
normcheck(delays.fit2,shapiro.wilk = TRUE)
```


```{r}
summary1way(delays.fit2)
cooks20x(delays.fit2)
```

```{r}
multipleComp(delays.fit2)
```

```{r}
exp(multipleComp(delays.fit2))[,1:3]
```

### **Methods and Assumption Checks**

The airline delays are numerical measurements made across 4 different groups of airlines. This suggests that we should use a one-way ANOVA or a linear regression model.

Assuming that our observations are independent, we initially tested our assumption of equality of variance with a linear model, which was not satisfied. This is because both Delta and United appear to differ relatively significantly from American or Alaska.

Our model is: $\log({\tt dep\_delays})_{i} = \beta_0 + \beta_1 \times {\tt America} + \beta_2 \times {\tt Delta} + \beta_3 \times {\tt United} + \varepsilon_{i}$ which explains