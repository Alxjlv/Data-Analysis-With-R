---
title: "Engsci 211 Task 3: Airline Delays"
author: "Alex Verkerk"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(s20x)
#laptop:/
setwd("C:/Users/Alex/Documents/GitHub/Engsci211Assignment2")
#home computer:
#setwd("I:/GitHub/Engsci 211/Engsci211Assignment2")
delays.df = read.table("delays.txt", header = TRUE)
head(delays.df)
```
### Exploratory Analysis
```{r}
#delays.fit = lm(dep_delay~airline, data = delays.df)
#layout20x(1,2)
#layout.matrix <- matrix(c(0,1),nrow=1,ncol=2)
#layout(mat=layout.matrix,
      # heights = c(1),#Height of the row
       #widths = c(2,2)) #Widths of the two columns
#par(mar = c(0,2,2,0))
plot(dep_delay~airline,data = delays.df)
#par(mar = c(3,3,3,3))
eovcheck(dep_delay~airline, data = delays.df)
```

```{r}
delays.fit = lm(dep_delay~airline, data = delays.df)
normcheck(delays.fit)
```

```{r}
boxplot(log(dep_delay)~airline, data = delays.df)
layout20x(1,2)
eovcheck(log(dep_delay)~airline,data=delays.df)
cooks20x(delays.fit)
```

```{r}
delays.fit2 = lm(log(dep_delay)~airline,data=delays.df)
normcheck(delays.fit2,shapiro.wilk = TRUE)
```


```{r}
summary1way(delays.fit2)
cooks20x(delays.fit2)
```

```{r}
multipleComp(delays.fit2)
```

```{r}
exp(multipleComp(delays.fit2))[,1:3]
```

### Methods and Assumption Checks

The airline delays are numerical measurements made across 4 different groups of airlines. This suggests that we should use a one-way ANOVA or a linear regression model.

Assuming that our observations are independent, we initially tested our assumption of equality of variance with a linear model, which appears unsatisfied. This is because both Delta and United appear to differ relatively significantly from American or Alaska. There appears to be an influential observation.

The Q-Q plot of our sample showed evidence of relatively significant right skewing of our data. This implies that a multiplicative model should be used, as the median will provide a better measure of centrality.

After applying a log transformation, the equality of variance and Normality assumptions appear to be satisfied. There are no longer any influential observations

The model fitted is $\log({\tt dep\_delays})_{i} = \beta_0 + \beta_1 \times {\tt America_{i}} + \beta_2 \times {\tt Delta_{i}} + \beta_3 \times {\tt United_{i}} + \varepsilon_{i}$ where $\tt America_i$ is 1 when looking at the delays for America airlines, $\tt Delta_i$ is 1 when looking at the delays for Delta airlines

### Executive Summary

